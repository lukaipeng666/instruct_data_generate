from assets import AssetManager

# 创建资产管理器
manager = AssetManager()

judge_prompt = """你是一个严格的AI对话数据质量评价专家。请对以下生成的对话数据进行严格评分。

## 任务描述
{meta_description}

## 生成的对话数据
{conversation_str}

{special}

## 评分标准（满分10分）
请从以下四个维度进行严格评分：

### 1. 任务符合度（3分）
- 3分：完全符合任务描述的所有要求
- 2分：基本符合任务描述，有轻微偏差
- 1分：部分符合任务描述，有明显问题
- 0分：不符合任务描述要求

### 2. 格式正确性（3分）
- 3分：输出格式完全正确，严格按照要求
- 2分：格式基本正确，有轻微问题
- 1分：格式有明显错误
- 0分：格式完全错误

### 3. 内容质量（2分）
- 2分：内容合理、自然，具有实际业务价值
- 1分：内容基本合理，但有些不自然
- 0分：内容不合理或不自然

### 4. 数据多样性（2分）
- 2分：与示例数据有明显差异，体现多样性
- 1分：与示例数据有一定差异
- 0分：与示例数据过于相似，缺乏多样性

## 评分要求
- 你必须扮演AI对话数据质量评价专家角色，严格依据上述标准评分
- 评分必须非常严格，只有完全符合所有要求才能得满分
- 任何细微的偏差都应扣分，禁止宽松打分
- 每项评分必须提供具体、可验证的分析依据，禁止模糊表述（如“较好”“基本满足”）
- 输出必须严格按照以下格式进行，不得增减标题、顺序或结构
- 最终评分仅输出一个整数，使用\\boxed{{}} 格式包裹

## 输出格式（必须严格遵守）
请严格按照以下结构输出，包括标题、加粗、换行和符号：

## 1. 任务符合度（3分）
**分析**：[逐条对照任务描述，分析是否完全符合。若存在任何偏差，必须明确指出具体内容。]
**得分**：X1分 

## 2. 格式正确性（3分）
**分析**：[检查输出结构、标签、换行、标点等是否完全符合要求等。指出是否存在格式疏漏或错误。不允许有任何错误，只能存在0分或3分。]
**得分**：X2分 

## 3. 内容质量（2分）
**分析**：[分析内容是否逻辑通顺、语言自然、无事实错误，数字计算是否正常，时间推演是否合理，是否具备实际应用价值等。指出是否存在生硬、重复或不合理表达。]
**得分**：X3分

## 4. 数据多样性（2分）
**分析**：[将本对话数据与典型示例对比，分析在表达方式、场景设计、意图分布等方面是否体现明显差异等。若雷同或模板化严重则扣分。]
**得分**：X4分

## 数据作废的情况
**分析** [尽可能从多种角度分析该数据的合理性，有任何不符合逻辑，或者不符合常理的内容，总分归零，总分归零时，无需进行分数计算。]
**总分是否归零**：True or False

## 最终评分
分数计算：X1 + X2 + X3 + X4 = X
\\boxed{{X}}"""

meta_description_up_load = """你是一名专业对话数据生成专家。请根据以下要素生成 {num_variants} 条符合要求的新对话：

## 任务描述
{meta_description}

## 示例对话
{conversation_str}

## 题材方向
{direction}

{special}

## 要求
1. **格式一致**：严格遵循示例结构，Assistant 回答按指定格式输出；Human 与 Assistant 轮流发言，轮数对等且交替。
2. **内容差异**：禁止复制示例，关键信息（如数值、地点、时间）需不同；内容须符合数学、语言、社会逻辑，具实际价值。
3. **先规划后生成**：
   - 对于每个题材，至少列举出5个不同的子内容，格式如下：
     题材一：  
     1. 内容一；  
     2. 内容二；  
     ...
   - 每个子题材中等概率抽取一个用于构造。
4. **输出格式**：
   - 先输出<plan></plan>的内容
   - 输出为单个可解析的 JSON 数组，用 ```json ``` 包裹；
   - 每项含 `turns` 键，值为交替的对话列表。

请严格按照以下格式输出：
<plan>
[在此进行简要规划，不超过300字]
</plan>

```json
[
  {{
    "turns": [
      {{"role": "Human", "text": "用户输入内容"}},
      {{"role": "Assistant", "text": "AI回答内容"}},
      // ... 更多对话回合，轮数必须对称
    ]
  }},
  {{
    "turns": [
      {{"role": "Human", "text": "用户输入内容"}},
      {{"role": "Assistant", "text": "AI回答内容"}},
      // ... 更多对话回合，轮数必须对称
    ]
  }}
]
```
⚠️ 注意：
- 确保 JSON 合法且轮次对称，否则视为无效。
- 确保中英文符合运用正确"""

SQL_gen = """你是数据库查询构造助手。请按以下输入，输出一条通用 SQL 及对应自然语言问题。

输入：
- 表名：{name}
- 表介绍（可选）：{information_title}
- 补充信息（可选）：{information_common}
- 查询列解释（非表中列名，构造SQL语句时请勿直接查询中文列名）：
{information_header}
- 可用查询列：
{information_header_query}
- 样本数据：
{rows_cur}

任务：
1. 读懂字段含义（可据列名+样本推断）。
2. 提出一个面向业务的自然语言问题（询问主体必须明确，不可构造模糊问题）。
3. 写出可执行的通用 SQL（支持聚合、筛选、分组、排序等）。

输出格式（仅 JSON）：
```json
{{
    "reason": "简述理由",
    "question": "自然语言问题",
    "SQL": "SQL 语句"
}}
```

要求：问题清晰，SQL 标准兼容（SQLite），勿局限于样本数据。"""

# 添加提示词
version = manager.prompts.add_prompt(
    domain="gen",
    task_name="问句改写", 
    meta_description=meta_description_up_load,
    commit_msg="0.0.1"
)

version = manager.prompts.add_prompt(
    domain="gen",
    task_name="SQL语句生成", 
    meta_description=SQL_gen,
    commit_msg="0.0.1"
)

version = manager.prompts.add_prompt(
    domain="gen",
    task_name="任务评价", 
    meta_description=judge_prompt,
    commit_msg="0.0.1"
)

